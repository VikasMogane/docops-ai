groups:
- name: workflow-slo
  rules:

  - record: workflow:success_rate:ratio
    expr: |
      sum(rate(workflow_completed_total[5m]))
      /
      sum(rate(workflow_started_total[5m]))

  - record: workflow:failure_rate:ratio
    expr: |
      sum(rate(workflow_failed_total[5m]))
      /
      sum(rate(workflow_started_total[5m]))

  - record: workflow:latency_p95
    expr: |
      histogram_quantile(
        0.95,
        sum by (le) (
          rate(workflow_step_duration_seconds_bucket[5m])
        )
      )
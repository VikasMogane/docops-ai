package com.docops.document.workflow;

import java.util.EnumSet;
import java.util.Map;

public final class DocumentWorkflow {

    private DocumentWorkflow() {}

    private static final Map<DocumentStatus, EnumSet<DocumentStatus>> RULES =
            Map.of(
                DocumentStatus.UPLOADED, EnumSet.of(DocumentStatus.PARSING, DocumentStatus.FAILED),
                DocumentStatus.PARSING, EnumSet.of(DocumentStatus.PARSED, DocumentStatus.FAILED),
                DocumentStatus.PARSED, EnumSet.of(DocumentStatus.ANALYZING, DocumentStatus.FAILED),
                DocumentStatus.ANALYZING, EnumSet.of(DocumentStatus.ANALYZING, DocumentStatus.FAILED),
                DocumentStatus.COMPLETED,EnumSet.of(DocumentStatus.COMPLETED, DocumentStatus.FAILED),
                DocumentStatus.FAILED, EnumSet.of(DocumentStatus.COMPLETED, DocumentStatus.FAILED)
            );

    public static boolean allowed(DocumentStatus from, DocumentStatus to) {
        return RULES.getOrDefault(from, EnumSet.noneOf(DocumentStatus.class))
                    .contains(to);
    }
}
